# -*- coding: utf-8 -*-
"""Bio_File_Format_Explorer.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1_KMBBQV1-Oxa4ZnvY0Tp_3JFVga7FHhD

# 🧬 Bioinformatics File Format Explorer

This mini-project reads and analyzes basic **biological file formats**:

- `.fasta` for DNA & protein sequences  
- `.pdb` for 3D protein structures  

We will:
- Preview FASTA files
- Extract basic sequence stats
- Visualize amino acid counts
- Parse 3D structure info from PDB

🔧 Tools: BioPython, Matplotlib, Py3Dmol (for Colab 3D view)
"""

!pip install biopython py3Dmol

from Bio import SeqIO, PDB
import py3Dmol
import matplotlib.pyplot as plt
import pandas as pd

"""## 📥 Upload a FASTA File (DNA or Protein)
You can upload a `.fasta` file (DNA or protein) and view its content.

"""

from google.colab import files
uploaded = files.upload()

fasta_file = list(uploaded.keys())[0]

record = SeqIO.read(fasta_file, "fasta")
sequence = str(record.seq)

print(f"🧾 Sequence ID: {record.id}")
print(f"🧬 Sequence Length: {len(sequence)}")
print(f"🧪 First 100 Bases/Residues:\n{sequence[:100]}...")

"""## 📊 Sequence Composition
We visualize the base (for DNA) or amino acid (for protein) composition.

"""

from collections import Counter

counts = Counter(sequence)
labels, values = zip(*sorted(counts.items()))

plt.figure(figsize=(10, 4))
plt.bar(labels, values, color='skyblue')
plt.title("Base / Residue Composition")
plt.xlabel("Symbol")
plt.ylabel("Count")
plt.grid(True, axis='y')
plt.show()

"""## 🧬 Upload a PDB File
Let's upload a `.pdb` structure file and render it using Py3Dmol.

"""

uploaded = files.upload()
pdb_file = list(uploaded.keys())[0]

# Show file name
print(f"📁 File: {pdb_file}")

# Read basic structure summary
parser = PDB.PDBParser()
structure = parser.get_structure("protein", pdb_file)

print("📊 PDB Structure Summary:")
for model in structure:
    for chain in model:
        print(f"⛓️ Chain: {chain.id}, Residues: {len(list(chain))}")

"""##📦 Code Cell – 3D Visualization of PDB (Optional)"""

with open(pdb_file, 'r') as file:
    pdb_data = file.read()

view = py3Dmol.view(width=600, height=400)
view.addModel(pdb_data, 'pdb')
view.setStyle({'cartoon': {'color': 'spectrum'}})
view.zoomTo()
view.show()

"""## ✅ Conclusion

This project explored:
- Reading `.fasta` sequence files using BioPython
- Calculating sequence length & base composition
- Reading and summarizing `.pdb` 3D structure files
- Rendering protein structure in Colab using `py3Dmol`



"""